   10 MODE 7
   20 BL$=CHR$(255) :REM BLOCK
   25 NBL$=" "      :REM NO BLOCK
   30 B$=CHR$(8)    :REM CURSOR BACK
   40 F$=CHR$(9)    :REM CURSOR FORWARD
   50 D$=CHR$(10)   :REM CURSOR DOWN
   60 U$=CHR$(11)   :REM CURSOR UP
   70 DIM SET$(3) : DIM NSET$(3)
   80 X=1 : Y=1 : P=1 : Z=0 : R=0
   90 REM Y=1
  100 REM P=1
  110 REM Z=0
  120 REM R=0
  130 GR$=CHR$(129)
  131 REM COLOUR
  132 L$=CHR$(141) : R$=CHR$(129) : G$=CHR$(130)
  133 Y$=CHR$(131) : GL$=CHR$(132) : M$=CHR$(133)
  134 C$=CHR$(134) : FL$=CHR$(136) : ST$=CHR$(137)
  140 DIM PRI$(1)
  150 PRI$(0)="PRESS W,A,S,D TO MOVE AND Q TO ROTATE  "
  160 PRI$(1)="PRESS E TO QUIT"
  170 DIM OBA$(3) :REM O BLOCK
  180 OBA$(0)=BL$+BL$+D$+B$+B$+BL$+BL$
  190 OBA$(1)=BL$+BL$+D$+B$+B$+BL$+BL$             :REM LOOP 01
  200 OBA$(2)=BL$+BL$+D$+B$+B$+BL$+BL$             :REM LOOP 02
  210 OBA$(3)=BL$+BL$+D$+B$+B$+BL$+BL$             :REM LOOP 03
  220 DIM IBA$(3) :REM I BLOCK
  230 IBA$(0)=BL$+D$+B$+BL$+D$+B$+BL$+D$+B$+BL$
  240 IBA$(1)=BL$+BL$+BL$+BL$
  250 IBA$(2)=BL$+D$+B$+BL$+D$+B$+BL$+D$+B$+BL$    :REM LOOP 01
  260 IBA$(3)=BL$+BL$+BL$+BL$                      :REM LOOP 02
  270 DIM SBA$(3) :REM S BLOCK
  280 SBA$(0)=F$+BL$+BL$+D$+B$+B$+B$+BL$+BL$+F$
  290 SBA$(1)=BL$+D$+B$+BL$+BL$+D$+B$+BL$
  300 SBA$(2)=F$+BL$+BL$+D$+B$+B$+B$+BL$+BL$+F$    :REM LOOP 01
  310 SBA$(3)=BL$+D$+B$+BL$+BL$+D$+B$+BL$          :REM LOOP 02
  310 DIM ZBA$(3) :REM Z BLOCK
  320 ZBA$(0)=BL$+BL$+D$+B$+B$+F$+BL$+BL$
  330 ZBA$(1)=F$+BL$+D$+B$+B$+BL$+BL$+D$+B$+B$+BL$
  340 ZBA$(2)=BL$+BL$+D$+B$+B$+F$+BL$+BL$          :REM LOOP 01
  350 ZBA$(3)=F$+BL$+D$+B$+B$+BL$+BL$+D$+B$+B$+BL$ :REM LOOP 02
  360 DIM LBA$(3) :REM L BLOCK
  370 LBA$(0)=BL$+D$+B$+BL$+D$+B$+BL$+BL$
  380 LBA$(1)=BL$+BL$+BL$+D$+B$+B$+B$+BL$
  390 LBA$(2)=BL$+BL$+D$+B$+BL$+D$+B$+BL$
  400 LBA$(3)=F$+F$+BL$+D$+B$+B$+B$+BL$+BL$+BL$
  410 DIM JBA$(3) :REM J BLOCK
  420 JBA$(0)=F$+BL$+D$+B$+BL$+D$+B$+B$+BL$+BL$
  430 JBA$(1)=BL$+D$+B$+BL$+BL$+BL$
  440 JBA$(2)=BL$+BL$+D$+B$+B$+BL$+D$+B$+BL$
  450 JBA$(3)=BL$+BL$+BL$+D$+B$+BL$
  460 DIM TBA$(3) :REM T BLOCK
  470 TBA$(0)=BL$+BL$+BL$+D$+B$+B$+BL$
  480 TBA$(1)=F$+BL$+D$+B$+B$+BL$+BL$+D$+B$+BL$
  490 TBA$(2)=F$+BL$+D$+B$+B$+BL$+BL$+BL$
  500 TBA$(3)=BL$+D$+B$+BL$+BL$+D$+B$+B$+BL$
      DIM EOBA$(3) :REM EMPTY O BLOCK
      EOBA$(0)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$
      EOBA$(1)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$             :REM LOOP 01
      EOBA$(2)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$             :REM LOOP 02
      EOBA$(3)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$             :REM LOOP 03
      DIM EIBA$(3) :REM EMPTY I BLOCK
      EIBA$(0)=NBL$+D$+B$+NBL$+D$+B$+NBL$+D$+B$+NBL$
      EIBA$(1)=NBL$+NBL$+NBL$+NBL$
      EIBA$(2)=NBL$+D$+B$+NBL$+D$+B$+NBL$+D$+B$+NBL$    :REM LOOP 01
      EIBA$(3)=NBL$+NBL$+NBL$+NBL$                      :REM LOOP 02
      DIM ESBA$(3) :REM EMPTY S BLOCK
      ESBA$(0)=F$+NBL$+NBL$+D$+B$+B$+B$+NBL$+NBL$+F$
      ESBA$(1)=NBL$+D$+B$+NBL$+NBL$+D$+B$+NBL$
      ESBA$(2)=F$+NBL$+NBL$+D$+B$+B$+B$+NBL$+NBL$+F$    :REM LOOP 01
      ESBA$(3)=NBL$+D$+B$+NBL$+NBL$+D$+B$+NBL$          :REM LOOP 02
      DIM EZBA$(3) :REM EMPTY Z BLOCK
      EZBA$(0)=NBL$+NBL$+D$+B$+B$+F$+NBL$+NBL$
      EZBA$(1)=F$+NBL$+D$+B$+B$+NBL$+NBL$+D$+B$+B$+NBL$
      EZBA$(2)=NBL$+NBL$+D$+B$+B$+F$+NBL$+NBL$          :REM LOOP 01
      EZBA$(3)=F$+NBL$+D$+B$+B$+NBL$+NBL$+D$+B$+B$+NBL$ :REM LOOP 02
      DIM ELBA$(3) :REM EMPTY L BLOCK
      ELBA$(0)=NBL$+D$+B$+NBL$+D$+B$+NBL$+NBL$
      ELBA$(1)=NBL$+NBL$+NBL$+D$+B$+B$+B$+NBL$
      ELBA$(2)=NBL$+NBL$+D$+B$+NBL$+D$+B$+NBL$
      ELBA$(3)=F$+F$+NBL$+D$+B$+B$+B$+NBL$+NBL$+NBL$
      DIM EJBA$(3) :REM EMPTY J BLOCK
      EJBA$(0)=F$+NBL$+D$+B$+NBL$+D$+B$+B$+NBL$+NBL$
      EJBA$(1)=NBL$+D$+B$+NBL$+NBL$+NBL$
      EJBA$(2)=NBL$+NBL$+D$+B$+B$+NBL$+D$+B$+NBL$
      EJBA$(3)=NBL$+NBL$+NBL$+D$+B$+NBL$
      DIM ETBA$(3) :REM EMPTY T BLOCK
      ETBA$(0)=NBL$+NBL$+NBL$+D$+B$+B$+NBL$
      ETBA$(1)=F$+NBL$+D$+B$+B$+NBL$+NBL$+D$+B$+NBL$
      ETBA$(2)=F$+NBL$+D$+B$+B$+NBL$+NBL$+NBL$
      ETBA$(3)=NBL$+D$+B$+NBL$+NBL$+D$+B$+B$+NBL$
      DIM OBAH$(3,3,3) :REM O BLOCK HIT BOX
      OBAH$(0,0,0)=BL$ :OBAH$(0,1,0)=BL$ :OBAH$(0,0,1)=BL$ :OBAH$(0,1,1)=BL$
      OBAH$(1,0,0)=BL$ :OBAH$(1,1,0)=BL$ :OBAH$(1,0,1)=BL$ :OBAH$(1,1,1)=BL$  :REM LOOP 01
      OBAH$(2,0,0)=BL$ :OBAH$(2,1,0)=BL$ :OBAH$(2,0,1)=BL$ :OBAH$(2,1,1)=BL$  :REM LOOP 02
      OBAH$(3,0,0)=BL$ :OBAH$(3,1,0)=BL$ :OBAH$(3,0,1)=BL$ :OBAH$(3,1,1)=BL$  :REM LOOP 03
      DIM IBAH$(3,3,3) :REM I BLOCK HIT BOX
      IBAH$(0,0,0)=BL$ :IBAH$(0,0,1)=BL$ :IBAH$(0,0,2)=BL$ :IBAH$(0,0,3)=BL$
      IBAH$(1,0,0)=BL$ :IBAH$(1,1,0)=BL$ :IBAH$(1,2,0)=BL$ :IBAH$(1,3,0)=BL$
      IBAH$(2,0,0)=BL$ :IBAH$(2,0,1)=BL$ :IBAH$(2,0,2)=BL$ :IBAH$(2,0,3)=BL$  :REM LOOP 01
      IBAH$(3,0,0)=BL$ :IBAH$(3,1,0)=BL$ :IBAH$(3,2,0)=BL$ :IBAH$(3,3,0)=BL$  :REM LOOP 02
      DIM SBAH$(3,3,3) :REM S BLOCK HIT BOX
      SBAH$(0,1,0)=BL$ :SBAH$(0,2,0)=BL$ :SBAH$(0,0,1)=BL$ :SBAH$(0,1,1)=BL$
      SBAH$(1,0,0)=BL$ :SBAH$(1,0,1)=BL$ :SBAH$(1,1,1)=BL$ :SBAH$(1,1,2)=BL$
      SBAH$(2,1,0)=BL$ :SBAH$(2,2,0)=BL$ :SBAH$(2,0,1)=BL$ :SBAH$(2,1,1)=BL$  :REM LOOP 01
      SBAH$(3,0,0)=BL$ :SBAH$(3,0,1)=BL$ :SBAH$(3,1,1)=BL$ :SBAH$(3,1,2)=BL$  :REM LOOP 02
      DIM ZBAH$(3,3,3) :REM Z BLOCK HIT BOX
      ZBAH$(0,0,0)=BL$ :ZBAH$(0,1,0)=BL$ :ZBAH$(0,1,1)=BL$ :ZBAH$(0,2,1)=BL$
      ZBAH$(1,1,0)=BL$ :ZBAH$(1,0,1)=BL$ :ZBAH$(1,1,1)=BL$ :ZBAH$(1,0,2)=BL$
      ZBAH$(2,0,0)=BL$ :ZBAH$(2,1,0)=BL$ :ZBAH$(2,1,1)=BL$ :ZBAH$(2,2,1)=BL$  :REM LOOP 01
      ZBAH$(3,1,0)=BL$ :ZBAH$(3,0,1)=BL$ :ZBAH$(3,1,1)=BL$ :ZBAH$(3,0,2)=BL$  :REM LOOP 02
      DIM LBAH$(3,3,3) :REM L BLOCK HIT BOX
      LBAH$(0,0,0)=BL$ :LBAH$(0,0,1)=BL$ :LBAH$(0,0,2)=BL$ :LBAH$(0,1,2)=BL$
      LBAH$(1,0,0)=BL$ :LBAH$(1,1,0)=BL$ :LBAH$(1,2,0)=BL$ :LBAH$(1,0,1)=BL$
      LBAH$(2,0,0)=BL$ :LBAH$(2,1,0)=BL$ :LBAH$(2,1,1)=BL$ :LBAH$(2,1,2)=BL$
      LBAH$(3,2,0)=BL$ :LBAH$(3,0,1)=BL$ :LBAH$(3,1,1)=BL$ :LBAH$(3,2,1)=BL$
      DIM JBAH$(3,3,3) :REM J BLOCK HIT BOX
      JBAH$(0,1,0)=BL$ :JBAH$(0,1,1)=BL$ :JBAH$(0,0,2)=BL$ :JBAH$(0,1,2)=BL$
      JBAH$(1,0,0)=BL$ :JBAH$(1,0,1)=BL$ :JBAH$(1,1,1)=BL$ :JBAH$(1,2,1)=BL$
      JBAH$(2,0,0)=BL$ :JBAH$(2,1,0)=BL$ :JBAH$(2,0,1)=BL$ :JBAH$(2,0,2)=BL$
      JBAH$(3,0,0)=BL$ :JBAH$(3,1,0)=BL$ :JBAH$(3,2,0)=BL$ :JBAH$(3,2,1)=BL$
      DIM TBAH$(3,3,3) :REM T BLOCK HIT BOX
      TBAH$(0,0,0)=BL$ :TBAH$(0,1,0)=BL$ :TBAH$(0,2,0)=BL$ :TBAH$(0,1,0)=BL$
      TBAH$(1,1,0)=BL$ :TBAH$(1,0,1)=BL$ :TBAH$(1,1,1)=BL$ :TBAH$(1,1,2)=BL$
      TBAH$(2,1,0)=BL$ :TBAH$(2,0,1)=BL$ :TBAH$(2,1,1)=BL$ :TBAH$(2,2,1)=BL$
      TBAH$(3,0,0)=BL$ :TBAH$(3,0,1)=BL$ :TBAH$(3,1,1)=BL$ :TBAH$(3,0,2)=BL$
  510 PROC_Main
  520 DEF PROC_Main
  525 PROC_Title
  530 REM PROC_ShapeID
  540 PROC_PlayerInput
  550 REM PROC_Print
  551 ENDPROC
  552 DEF PROC_Title
  553 CLS
  554 PRINTTAB(9,0) L$Y$"CROESO I PEDAIR-O" : PRINTTAB(9,1)L$M$"CROESO I PEDAIR-O"
  555 PRINTTAB(2,3) R$"Options  for PEDAIR-O:" : PRINTTAB(2,5)"S - To Show a List Of Shapes"
  556 PRINTTAB(2,7) GL$"Controls:"
  557 PRINTTAB(2,9) "Z - To Move Left"
  558 PRINTTAB(2,11) "X - To Move Right"
  559 PRINTTAB(2,13) "RIGHT SHIFT - To Rotate"
  560 PRINTTAB(2,16) FL$"SPACE" ; :PRINT ST$"- To Start The Game"
  561 PRINTTAB(2,18) "     L - To Exit From Game" : PRINTTAB(9,20)"MAKE BY" ; : PRINT R$"Dunvant_Kai"
  562 K%=INKEY(0)  :REM 562
  563 IF K%=32 THEN PROC_Random : ENDPROC  :REM START GAME
  564 IF K%=76 THEN CLS : PRINTTAB(4,5)"THANK YOU FOR PLAYER MY GAME ^^" : PRINTTAB(9,10)"MAKE BY"; : PRINT R$"Dunvant_Kai" : PRINTTAB(9,20)LBA$(0) :END : LEAVE GAME
  565 IF K%=83 THEN PROC_ShapeID : ENDPROC  : OPEN SHAPES
  566 GOTO 562 :REM 562
  567 ENDPROC
  568 DEF PROC_Random
  569 RAND%=RND(7)   :REM CHANGE BACK TO 7 AFTER DONE
  570 IF RAND% = 1 THEN CLS : FOR S=0 TO 3 : SET$(S)=OBA$(S) : SBL$=NBL$ : NSET$(S)=OBA$(S) : SBL$=BL$ : NEXT S : PRINT R$PRI$(0)R$PRI$(1)
  571 IF RAND% = 2 THEN CLS : FOR S=0 TO 3 : SET$(S)=TBA$(S) : SBL$=NBL$ : NSET$(S)=TBA$(S) : SBL$=BL$ : NEXT S : PRINT R$PRI$(0)R$PRI$(1)
  572 IF RAND% = 3 THEN CLS : FOR S=0 TO 3 : SET$(S)=SBA$(S) : SBL$=NBL$ : NSET$(S)=SBA$(S) : SBL$=BL$ : NEXT S : PRINT R$PRI$(0)R$PRI$(1)
  573 IF RAND% = 4 THEN CLS : FOR S=0 TO 3 : SET$(S)=ZBA$(S) : SBL$=NBL$ : NSET$(S)=ZBA$(S) : SBL$=BL$ : NEXT S : PRINT R$PRI$(0)R$PRI$(1)
  574 IF RAND% = 5 THEN CLS : FOR S=0 TO 3 : SET$(S)=LBA$(S) : SBL$=NBL$ : NSET$(S)=LBA$(S) : SBL$=BL$ : NEXT S : PRINT R$PRI$(0)R$PRI$(1)
  575 IF RAND% = 6 THEN CLS : FOR S=0 TO 3 : SET$(S)=JBA$(S) : SBL$=NBL$ : NSET$(S)=JBA$(S) : SBL$=BL$ : NEXT S : PRINT R$PRI$(0)R$PRI$(1)
  576 IF RAND% = 7 THEN CLS : FOR S=0 TO 3 : SET$(S)=IBA$(S) : SBL$=NBL$ : NSET$(S)=IBA$(S) : SBL$=BL$ : NEXT S : PRINT R$PRI$(0)R$PRI$(1)
  577 PROC_PlayerInput : ENDPROC
  578 DEF PROC_ShapeID
  580 CLS
  590 PRINTTAB(0,0)OBA$(0) ; :PRINT " BLOCK O"
  600 PRINTTAB(20,0)TBA$(0) ; :PRINT " BLOCK T"
  610 PRINTTAB(0,5)SBA$(0) ; :PRINT " BLOCK S"
  620 PRINTTAB(20,5)ZBA$(0) ; :PRINT " BLOCK Z"
  630 PRINTTAB(0,10)LBA$(0) ; :PRINT " BLOCK L"
  640 PRINTTAB(20,10)JBA$(0) ; :PRINT " BLOCK J"
  650 PRINTTAB(0,15)IBA$(0) ; :PRINT " BLOCK I"
  651 PRINTTAB(5,21)"L - TO GO BACK TO MAIN MENU"
  652 K%=INKEY(0)  :REM 652
  653 IF K%=76 THEN PROC_Title
  654 GOTO 652 :REM 652
  760 ENDPROC
  770 DEF PROC_PlayerInput
  780 REM WHILE TRUE:REM REPEAT
  790 K%=INKEY(0)   :REM 790
  800 IF X>38 THEN X=38
  810 IF X<0 THEN X=0
  820 IF Y>15 THEN Y=14
  830 IF Y<0 THEN Y=0
  840 IF K%=87 OR K%=119 THEN PRINTTAB(X,Y)NSET$(R) : Y=Y-1 :PROC_Print :REM W
  850 IF K%=83 OR K%=115 THEN PRINTTAB(X,Y)NSET$(R) : Y=Y+1 :PROC_Print :REM S
  860 IF K%=68 OR K%=100 THEN PRINTTAB(X,Y)NSET$(R) : X=X+1 :PROC_Print :REM D
  870 IF K%=65 OR K%=97  THEN PRINTTAB(X,Y)NSET$(R) : X=X-1 :PROC_Print :REM A
  880 IF K%=81 OR K%=113 THEN PRINTTAB(X,Y)NSET$(R) : R=R+1 :IF R>3 THEN R=0 :REM ROTATES PEASE AND MAKE SURE IT STAYS IN BOUNDS
  890 IF K%=81 OR K%=113 THEN PROC_Print :REM Q TO ROTAE
  900 IF K%=69 OR K%=101 PROC_RESET
  910 GOTO 790 :REM UNTIL FALSE FIX LATTER CANT BE LEFT  :REM 790
  920 ENDPROC
  930 DEF PROC_Print
  940 PRINT SBL$ :REM CLS
  950 PRINTTAB(X,Y)SET$(R)
  970 REMPRINTLEN(SET$(I))
  980 REM PROC_PlayerInput
  990 ENDPROC
 1000 DEF PROC_RESET
 1010 X=1
 1020 Y=1
 1030 R=0
 1040 PROC_Main
 1050 END PROC
