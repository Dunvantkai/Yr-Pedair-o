   10 MODE 7
   20 BL$=CHR$(255) :REM BLOCK
   30 NBL$=" "      :REM NO BLOCK
   40 B$=CHR$(8)    :REM CURSOR BACK
   50 F$=CHR$(9)    :REM CURSOR FORWARD
   60 D$=CHR$(10)   :REM CURSOR DOWN
   70 U$=CHR$(11)   :REM CURSOR UP
   80 DIM SET$(3)   :REM SET CHARITOR BLOCK
   90 DIM NSET$(3)  :REM SET THE MEGATIVE OF CHARITOR BLOCK
   91 DIM SETHB$(3,3,3) :REM DEFINES SET BLOCKS HIT BOX
   92 DIM SCREEN$(14,21) :REM SCREAN ARRAY SIZE
   95 X=3 :Y=0 :R=0 :REM BLOCK X,Y,R POSITION AND ROTAION
   98 AMSER=0 : DP=TRUE : LEAVE=FALSE : START=FALSE : ACTIONS$="NULL" :REM AMSER TIME CLOCK. DP DOWN CHECK. LEAVE THE GAME
  100 SETAMSER=1000000 :REM SETMAX CLOCK TICK
  110 REM COLOUR
  115 L$=CHR$(141) : ST$=CHR$(137) : G$=CHR$(130)
  120 Y$=CHR$(131) : GL$=CHR$(132) : M$=CHR$(133)
  130 C$=CHR$(134) : FL$=CHR$(136) : R$=CHR$(129)
  140 FOR YA=0 TO 21 : SCREEN$(11,YA)=BL$ : NEXT YA : FOR XA=0 TO 10 : SCREEN$(XA,18)=BL$ : NEXT XA  :REM BUILDS BLOCK WALL AT THE EDGE OF GAME WALL
  161 NIT$=NBL$+NBL$+NBL$+NBL$+D$+B$+B$+B$+B$+NBL$+NBL$+NBL$+NBL$+D$+B$+B$+B$+B$+NBL$+NBL$+NBL$+NBL$+D$+B$+B$+B$+B$+NBL$+NBL$+NBL$+NBL$ :REM TO BE USED TO CLEAR NEXT BLOCK AREA
  170 DIM OBA$(3) :REM O BLOCK
  180 OBA$(0)=BL$+BL$+D$+B$+B$+BL$+BL$
  190 OBA$(1)=BL$+BL$+D$+B$+B$+BL$+BL$             :REM LOOP 01
  200 OBA$(2)=BL$+BL$+D$+B$+B$+BL$+BL$             :REM LOOP 02
  210 OBA$(3)=BL$+BL$+D$+B$+B$+BL$+BL$             :REM LOOP 03
  220 DIM IBA$(3) :REM I BLOCK
  230 IBA$(0)=BL$+D$+B$+BL$+D$+B$+BL$+D$+B$+BL$
  240 IBA$(1)=BL$+BL$+BL$+BL$
  250 IBA$(2)=BL$+D$+B$+BL$+D$+B$+BL$+D$+B$+BL$    :REM LOOP 01
  260 IBA$(3)=BL$+BL$+BL$+BL$                      :REM LOOP 02
  270 DIM SBA$(3) :REM S BLOCK
  280 SBA$(0)=F$+BL$+BL$+D$+B$+B$+B$+BL$+BL$+F$
  290 SBA$(1)=BL$+D$+B$+BL$+BL$+D$+B$+BL$
  300 SBA$(2)=F$+BL$+BL$+D$+B$+B$+B$+BL$+BL$+F$    :REM LOOP 01
  310 SBA$(3)=BL$+D$+B$+BL$+BL$+D$+B$+BL$          :REM LOOP 02
  310 DIM ZBA$(3) :REM Z BLOCK
  320 ZBA$(0)=BL$+BL$+D$+B$+B$+F$+BL$+BL$
  330 ZBA$(1)=F$+BL$+D$+B$+B$+BL$+BL$+D$+B$+B$+BL$
  340 ZBA$(2)=BL$+BL$+D$+B$+B$+F$+BL$+BL$          :REM LOOP 01
  350 ZBA$(3)=F$+BL$+D$+B$+B$+BL$+BL$+D$+B$+B$+BL$ :REM LOOP 02
  360 DIM LBA$(3) :REM L BLOCK
  370 LBA$(0)=BL$+D$+B$+BL$+D$+B$+BL$+BL$
  380 LBA$(1)=BL$+BL$+BL$+D$+B$+B$+B$+BL$
  390 LBA$(2)=BL$+BL$+D$+B$+BL$+D$+B$+BL$
  400 LBA$(3)=F$+F$+BL$+D$+B$+B$+B$+BL$+BL$+BL$
  410 DIM JBA$(3) :REM J BLOCK
  420 JBA$(0)=F$+BL$+D$+B$+BL$+D$+B$+B$+BL$+BL$
  430 JBA$(1)=BL$+D$+B$+BL$+BL$+BL$
  440 JBA$(2)=BL$+BL$+D$+B$+B$+BL$+D$+B$+BL$
  450 JBA$(3)=BL$+BL$+BL$+D$+B$+BL$
  460 DIM TBA$(3) :REM T BLOCK
  470 TBA$(0)=BL$+BL$+BL$+D$+B$+B$+BL$
  480 TBA$(1)=F$+BL$+D$+B$+B$+BL$+BL$+D$+B$+BL$
  490 TBA$(2)=F$+BL$+D$+B$+B$+BL$+BL$+BL$
  500 TBA$(3)=BL$+D$+B$+BL$+BL$+D$+B$+B$+BL$
  505 PRINT"GRAPHIC BLOCKS DEFINED"
  510 DIM EOBA$(3) :REM EMPTY O BLOCK
  520 EOBA$(0)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$
  530 EOBA$(1)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$             :REM LOOP 01
  540 EOBA$(2)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$             :REM LOOP 02
  550 EOBA$(3)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$             :REM LOOP 03
  560 DIM EIBA$(3) :REM EMPTY I BLOCK
  570 EIBA$(0)=NBL$+D$+B$+NBL$+D$+B$+NBL$+D$+B$+NBL$
  580 EIBA$(1)=NBL$+NBL$+NBL$+NBL$
  590 EIBA$(2)=NBL$+D$+B$+NBL$+D$+B$+NBL$+D$+B$+NBL$    :REM LOOP 01
  600 EIBA$(3)=NBL$+NBL$+NBL$+NBL$                      :REM LOOP 02
  610 DIM ESBA$(3) :REM EMPTY S BLOCK
  620 ESBA$(0)=F$+NBL$+NBL$+D$+B$+B$+B$+NBL$+NBL$+F$
  630 ESBA$(1)=NBL$+D$+B$+NBL$+NBL$+D$+B$+NBL$
  640 ESBA$(2)=F$+NBL$+NBL$+D$+B$+B$+B$+NBL$+NBL$+F$    :REM LOOP 01
  650 ESBA$(3)=NBL$+D$+B$+NBL$+NBL$+D$+B$+NBL$          :REM LOOP 02
  660 DIM EZBA$(3) :REM EMPTY Z BLOCK
  670 EZBA$(0)=NBL$+NBL$+D$+B$+B$+F$+NBL$+NBL$
  680 EZBA$(1)=F$+NBL$+D$+B$+B$+NBL$+NBL$+D$+B$+B$+NBL$
  690 EZBA$(2)=NBL$+NBL$+D$+B$+B$+F$+NBL$+NBL$          :REM LOOP 01
  700 EZBA$(3)=F$+NBL$+D$+B$+B$+NBL$+NBL$+D$+B$+B$+NBL$ :REM LOOP 02
  710 DIM ELBA$(3) :REM EMPTY L BLOCK
  720 ELBA$(0)=NBL$+D$+B$+NBL$+D$+B$+NBL$+NBL$
  730 ELBA$(1)=NBL$+NBL$+NBL$+D$+B$+B$+B$+NBL$
  740 ELBA$(2)=NBL$+NBL$+D$+B$+NBL$+D$+B$+NBL$
  750 ELBA$(3)=F$+F$+NBL$+D$+B$+B$+B$+NBL$+NBL$+NBL$
  760 DIM EJBA$(3) :REM EMPTY J BLOCK
  770 EJBA$(0)=F$+NBL$+D$+B$+NBL$+D$+B$+B$+NBL$+NBL$
  780 EJBA$(1)=NBL$+D$+B$+NBL$+NBL$+NBL$
  790 EJBA$(2)=NBL$+NBL$+D$+B$+B$+NBL$+D$+B$+NBL$
  800 EJBA$(3)=NBL$+NBL$+NBL$+D$+B$+NBL$
  810 DIM ETBA$(3) :REM EMPTY T BLOCK
  820 ETBA$(0)=NBL$+NBL$+NBL$+D$+B$+B$+NBL$
  830 ETBA$(1)=F$+NBL$+D$+B$+B$+NBL$+NBL$+D$+B$+NBL$
  840 ETBA$(2)=F$+NBL$+D$+B$+B$+NBL$+NBL$+NBL$
  850 ETBA$(3)=NBL$+D$+B$+NBL$+NBL$+D$+B$+B$+NBL$
  855 PRINT"EMPTY GRAPHIC BLOCKS DEFINED"
  860 DIM OBAH$(3,3,3) :REM O BLOCK HIT BOX
  870 OBAH$(0,0,0)=BL$ :OBAH$(0,1,0)=BL$ :OBAH$(0,0,1)=BL$ :OBAH$(0,1,1)=BL$
  880 OBAH$(1,0,0)=BL$ :OBAH$(1,1,0)=BL$ :OBAH$(1,0,1)=BL$ :OBAH$(1,1,1)=BL$  :REM LOOP 01
  890 OBAH$(2,0,0)=BL$ :OBAH$(2,1,0)=BL$ :OBAH$(2,0,1)=BL$ :OBAH$(2,1,1)=BL$  :REM LOOP 02
  900 OBAH$(3,0,0)=BL$ :OBAH$(3,1,0)=BL$ :OBAH$(3,0,1)=BL$ :OBAH$(3,1,1)=BL$  :REM LOOP 03
  910 DIM IBAH$(3,3,3) :REM I BLOCK HIT BOX
  920 IBAH$(0,0,0)=BL$ :IBAH$(0,0,1)=BL$ :IBAH$(0,0,2)=BL$ :IBAH$(0,0,3)=BL$
  930 IBAH$(1,0,0)=BL$ :IBAH$(1,1,0)=BL$ :IBAH$(1,2,0)=BL$ :IBAH$(1,3,0)=BL$
  940 IBAH$(2,0,0)=BL$ :IBAH$(2,0,1)=BL$ :IBAH$(2,0,2)=BL$ :IBAH$(2,0,3)=BL$  :REM LOOP 01
  950 IBAH$(3,0,0)=BL$ :IBAH$(3,1,0)=BL$ :IBAH$(3,2,0)=BL$ :IBAH$(3,3,0)=BL$  :REM LOOP 02
  960 DIM SBAH$(3,3,3) :REM S BLOCK HIT BOX
  970 SBAH$(0,1,0)=BL$ :SBAH$(0,2,0)=BL$ :SBAH$(0,0,1)=BL$ :SBAH$(0,1,1)=BL$
  980 SBAH$(1,0,0)=BL$ :SBAH$(1,0,1)=BL$ :SBAH$(1,1,1)=BL$ :SBAH$(1,1,2)=BL$
  990 SBAH$(2,1,0)=BL$ :SBAH$(2,2,0)=BL$ :SBAH$(2,0,1)=BL$ :SBAH$(2,1,1)=BL$  :REM LOOP 01
 1000 SBAH$(3,0,0)=BL$ :SBAH$(3,0,1)=BL$ :SBAH$(3,1,1)=BL$ :SBAH$(3,1,2)=BL$  :REM LOOP 02
 1010 DIM ZBAH$(3,3,3) :REM Z BLOCK HIT BOX
 1020 ZBAH$(0,0,0)=BL$ :ZBAH$(0,1,0)=BL$ :ZBAH$(0,1,1)=BL$ :ZBAH$(0,2,1)=BL$
 1030 ZBAH$(1,1,0)=BL$ :ZBAH$(1,0,1)=BL$ :ZBAH$(1,1,1)=BL$ :ZBAH$(1,0,2)=BL$
 1040 ZBAH$(2,0,0)=BL$ :ZBAH$(2,1,0)=BL$ :ZBAH$(2,1,1)=BL$ :ZBAH$(2,2,1)=BL$  :REM LOOP 01
 1050 ZBAH$(3,1,0)=BL$ :ZBAH$(3,0,1)=BL$ :ZBAH$(3,1,1)=BL$ :ZBAH$(3,0,2)=BL$  :REM LOOP 02
 1060 DIM LBAH$(3,3,3) :REM L BLOCK HIT BOX
 1070 LBAH$(0,0,0)=BL$ :LBAH$(0,0,1)=BL$ :LBAH$(0,0,2)=BL$ :LBAH$(0,1,2)=BL$
 1080 LBAH$(1,0,0)=BL$ :LBAH$(1,1,0)=BL$ :LBAH$(1,2,0)=BL$ :LBAH$(1,0,1)=BL$
 1090 LBAH$(2,0,0)=BL$ :LBAH$(2,1,0)=BL$ :LBAH$(2,1,1)=BL$ :LBAH$(2,1,2)=BL$
 1100 LBAH$(3,2,0)=BL$ :LBAH$(3,0,1)=BL$ :LBAH$(3,1,1)=BL$ :LBAH$(3,2,1)=BL$
 1110 DIM JBAH$(3,3,3) :REM J BLOCK HIT BOX
 1120 JBAH$(0,1,0)=BL$ :JBAH$(0,1,1)=BL$ :JBAH$(0,0,2)=BL$ :JBAH$(0,1,2)=BL$
 1130 JBAH$(1,0,0)=BL$ :JBAH$(1,0,1)=BL$ :JBAH$(1,1,1)=BL$ :JBAH$(1,2,1)=BL$
 1140 JBAH$(2,0,0)=BL$ :JBAH$(2,1,0)=BL$ :JBAH$(2,0,1)=BL$ :JBAH$(2,0,2)=BL$
 1150 JBAH$(3,0,0)=BL$ :JBAH$(3,1,0)=BL$ :JBAH$(3,2,0)=BL$ :JBAH$(3,2,1)=BL$
 1160 DIM TBAH$(3,3,3) :REM T BLOCK HIT BOX
 1170 TBAH$(0,0,0)=BL$ :TBAH$(0,1,0)=BL$ :TBAH$(0,2,0)=BL$ :TBAH$(0,1,1)=BL$
 1180 TBAH$(1,1,0)=BL$ :TBAH$(1,0,1)=BL$ :TBAH$(1,1,1)=BL$ :TBAH$(1,1,2)=BL$
 1190 TBAH$(2,1,0)=BL$ :TBAH$(2,0,1)=BL$ :TBAH$(2,1,1)=BL$ :TBAH$(2,2,1)=BL$
 1200 TBAH$(3,0,0)=BL$ :TBAH$(3,0,1)=BL$ :TBAH$(3,1,1)=BL$ :TBAH$(3,0,2)=BL$
 1210 PRINT"HIT BOX BLOCKS DEFINED"
 1225 PROC_Title
 1521 IF START=TRUE THEN PROC_Random : PROC_NEXTBLOCK : PROC_SCREEN
 1522 REM MainLoop
 1523 PROC_PlayerInput
 1524 IF ACTIONS$="LEFT" THEN PROC_LEFT
 1525 IF ACTIONS$="RIGHT" THEN PROC_RIGHT
 1526 IF ACTIONS$="ROTATE" THEN PROC_ROTATE
 1527 IF ACTIONS$="DOWN" THEN PROC_DOWN
 1528 ACTIONS$="NULL"
 1529 PROC_TIME
 1530 IF AMSER > SETAMSER THEN PROC_DOWN : AMSER=0
 1532 IF LEAVE=FALSE THEN GOTO 1522
 1533 IF LEAVE=TRUE THEN PROC_RESET : REM FOR YA=0 TO 17 : FOR XA=0 TO 10 : SCREEN$(XA,YA)="k" : NEXT XA : NEXT YA
 1534 LEAVE=FALSE : GOTO 1225
 1552 DEF PROC_Title
 1553 CLS
 1554 PRINTTAB(9,0) L$Y$"CROESO I PEDAIR-O" : PRINTTAB(9,1)L$M$"CROESO I PEDAIR-O"
 1555 PRINTTAB(2,3) R$"Options  for PEDAIR-O:" : PRINTTAB(2,5)"S - To Show a List Of Shapes"
 1556 PRINTTAB(2,7) GL$"Controls:"
 1557 PRINTTAB(2,9) "P - To Drop"
 1558 PRINTTAB(2,11) "O - To Rotate"
 1559 PRINTTAB(2,13) "Z - To Move Left" : PRINTTAB(2,15) "X - To Move Right"
 1560 PRINTTAB(2,19) FL$"SPACE" ; :PRINT ST$"- To Start The Game"
 1561 PRINTTAB(2,21) "     L - To Exit From Game" : PRINTTAB(9,23)"MAKE BY" ; : PRINT R$"Dunvant_Kai"
 1562 K%=INKEY(0)  :REM 562
 1563 IF K%=32 THEN RAND%=RND(7)  : START=TRUE : ENDPROC  :REM START GAME
 1564 IF K%=76 THEN CLS : PRINTTAB(4,5)"THANK YOU FOR PLAYER MY GAME ^^" : PRINTTAB(9,10)"MAKE BY"; : PRINT R$"Dunvant_Kai" : PRINTTAB(9,20)LBA$(0) :END : LEAVE GAME
 1565 IF K%=83 THEN PROC_ShapeID : ENDPROC  : OPEN SHAPES
 1566 GOTO 1562 :REM 562
 1567 ENDPROC
 1568 DEF PROC_Random
 1569 RAND%=RND(7)
 1570 IF RAND% = 1 THEN CLS : FOR S=0 TO 3 : SET$(S)=OBA$(S) : NSET$(S)=EOBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=OBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM O BLOCK
 1571 IF RAND% = 2 THEN CLS : FOR S=0 TO 3 : SET$(S)=TBA$(S) : NSET$(S)=ETBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=TBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM T BLOCK
 1572 IF RAND% = 3 THEN CLS : FOR S=0 TO 3 : SET$(S)=SBA$(S) : NSET$(S)=ESBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=SBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM S BLOCK
 1573 IF RAND% = 4 THEN CLS : FOR S=0 TO 3 : SET$(S)=ZBA$(S) : NSET$(S)=EZBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=ZBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM Z BLOCK
 1574 IF RAND% = 5 THEN CLS : FOR S=0 TO 3 : SET$(S)=LBA$(S) : NSET$(S)=ELBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=LBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM L BLOCK
 1575 IF RAND% = 6 THEN CLS : FOR S=0 TO 3 : SET$(S)=JBA$(S) : NSET$(S)=EJBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=JBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM J BLOCK
 1576 IF RAND% = 7 THEN CLS : FOR S=0 TO 3 : SET$(S)=IBA$(S) : NSET$(S)=EIBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=IBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM I BLOCK
 1577 RAND%=RND(7)
 1578 ENDPROC
 1579 DEF PROC_ShapeID
 1580 CLS
 1590 PRINTTAB(0,0)OBA$(0) ; :PRINT " BLOCK O"
 1600 PRINTTAB(20,0)TBA$(0) ; :PRINT " BLOCK T"
 1610 PRINTTAB(0,5)SBA$(0) ; :PRINT " BLOCK S"
 1620 PRINTTAB(20,5)ZBA$(0) ; :PRINT " BLOCK Z"
 1630 PRINTTAB(0,10)LBA$(0) ; :PRINT " BLOCK L"
 1640 PRINTTAB(20,10)JBA$(0) ; :PRINT " BLOCK J"
 1650 PRINTTAB(0,15)IBA$(0) ; :PRINT " BLOCK I"
 1651 PRINTTAB(5,21)"L - TO GO BACK TO MAIN MENU"
 1652 K%=INKEY(0)  :REM 652
 1653 IF K%=76 THEN ENDPROC
 1654 GOTO 1652 :REM 652
 1760 ENDPROC
 1770 DEF PROC_PlayerInput
 1780 REM AMSER%=0 :REM WHILE TRUE:REM REPEAT
 1790 K%=INKEY(0)   :REM 790
 1800 IF K%=122 OR K%=90 THEN ACTIONS$="LEFT"   : ENDPROC : REM PROC_LEFT   :REM Z FOR LEFT
 1810 IF K%=120 OR K%=88 THEN ACTIONS$="RIGHT"  : ENDPROC : REM PROC_RIGHT  :REM X FOR RITGT
 1820 IF K%=111 OR K%=79 THEN ACTIONS$="ROTATE" : ENDPROC : REM PROC_ROTATE :REM O FOR ROTATE
 1830 IF K%=112 OR K%=80 THEN ACTIONS$="DOWN"   : ENDPROC : REM PROC_DOWN :REM P FOR DROP
 1840 IF K%=108 OR K%=76 THEN LEAVE=TRUE        : ENDPROC : REM PROC_RESET :REM L FOR EXIT
 1850 REM PROC_TIME : IF AMSER > SETAMSER THEN PROC_DOWN : AMSER=0
 1920 ENDPROC
 1930 DEF PROC_Print
 1940 REM PRINT SBL$ :REM CLS
 1950 REM PRINTTAB(X+14,Y+3)SET$(R)
 1955 FOR SX=0 TO 10 : FOR SY=0 TO 18 : PRINTTAB(SX+14,SY+3) SCREEN$(SX,SY) : NEXT SY : NEXT SX
 1970 REM PROC_SCREEN
 1980 REM PROC_PlayerInput
 1990 ENDPROC
 2000 DEF PROC_RESET
 2010 X=6
 2020 Y=0
 2030 R=0
 2035 ENDPROC
 2040 PROC_Main
 2050 END PROC
 2060 DEF PROC_SCREEN
 2070 FOR LW=3 TO 20 : PRINTTAB(12,LW)CHR$(255) : NEXT LW     :REM LEFT BLOCKS RENDER
 2080 FOR RW=3 TO 20 : PRINTTAB(26,RW)CHR$(255) : NEXT RW     :REM RIGHT BLOCKS RENDER
 2090 FOR BW=12 TO 26 : PRINTTAB(BW,21)CHR$(255) : NEXT BW    :REM BOTTOM BLOCKS RENDER
 2100 FOR LC=3 TO 21 : PRINTTAB(11,LC)CHR$(145) : NEXT LC     :REM LEFT AND BOTTOM BLOCK GRAFIC CONTROLL
 2110 FOR RC=3 TO 20 : PRINTTAB(25,RC)CHR$(145) : NEXT RC     :REM RIGHT BLOCK GRAFIC CONTROLL
 2120 FOR MC1=3 TO 7 : PRINTTAB(13,MC1)CHR$(130) : NEXT MC1   :REM 1ST MIDDLE GAME TEXT RENDER
 2130 FOR MC2=8 TO 11 : PRINTTAB(13,MC2)CHR$(131) : NEXT MC2  :REM 2ND MIDDLE GAME TEXT RENDER
 2140 FOR MC3=12 TO 15 :PRINTTAB(13,MC3)CHR$(132) : NEXT MC3  :REM 3RD MIDDLE GAME TEXT RENDER
 2150 FOR MC4=16 TO 20 :PRINTTAB(13,MC4)CHR$(133) : NEXT MC4  :REM 4TH MIDDLE GAME TEXT RENDER
 2160 PRINTTAB(13,0)L$Y$"PEDAIR--O" : PRINTTAB(13,1)L$M$"PEDAIR--O"
 2170 PRINTTAB(30,13)CHR$(135)"NEXT :"
 2180 FOR WBN=30 TO 37 : PRINTTAB(WBN,12)BL$ : NEXT WBN   :REM WRIGHT BOTTOM LINE FOR NEXT
 2190 FOR WLN=6 TO 11 : PRINTTAB(30,WLN)BL$ : NEXT WLN   :REM WRIGHT LEFT LINE FOR NEXT
 2200 FOR WRN=6 TO 11 : PRINTTAB(37,WRN)BL$ : NEXT WRN   :REM WRIGHT RIGHT LEIN FOR NEXT
 2210 FOR WLT=6 TO 10 : PRINTTAB(31,WLT)CHR$(135) : NEXT WLT  :REM WRIGHT LEFT TEXT MODE
 2220 FOR WRT=6 TO 10 : PRINTTAB(36,WRT)CHR$(145) : NEXT WRT
 2230 PRINTTAB(0,6)CHR$(134)"Controls:"
 2240 PRINTTAB(1,8)"Z = LEFT"
 2250 PRINTTAB(1,10)"X = RIGHT"
 2260 PRINTTAB(1,12)"O = ROTATE"
 2270 PRINTTAB(1,14)"P = DROP"
 2280 PRINTTAB(1,16)"L = PAUSE"
 2285 PROC_Print
 2290 ENDPROC
 2300 DEF PROC_PRINTSHAPE
 2310 PRINTTAB(X+14,Y+3)SET$(R)
 2320 ENDPROC
 2330 DEF PROC_LEFT
 2335 BREAKLT=FALSE :REM TO MAKE SURE THERE ARE NO EAIRLY BREAKS CORZING Memory Constraints
 2340 IF X-1 < 0 THEN ENDPROC  :REM HARD CHECK ON WALL
 2350 IF BREAKLT=FALSE THEN FOR SX=0 TO 3 : FOR SY=0 TO 3 : IF SETHB$(R,SX,SY) = BL$ : IF SETHB$(R,SX,SY) = SCREEN$(SX+X-1,SY+Y) THEN BREAKLT=TRUE
 2355 NEXT SY : NEXT SX
 2360 IF BREAKLT=FALSE THEN PRINTTAB(X+14,Y+3)NSET$(R) : X=X-1 : PROC_PRINTSHAPE
 2370 ENDPROC
 2380 DEF PROC_RIGHT
 2385 BREAKRT=FALSE :REM TO MAKE SURE THERE ARE NO EAIRLY BREAKS CORZING Memory Constraints
 2390 IF X+1 > 10 THEN ENDPROC :REM HARD CHECK ON WALL
 2400 IF BREAKRT=FALSE THEN FOR SX=0 TO 3 : FOR SY=0 TO 3 : IF SETHB$(R,SX,SY) = BL$ : IF SETHB$(R,SX,SY) = SCREEN$(SX+X+1,SY+Y) THEN BREAKRT=TRUE
 2405 NEXT SY : NEXT SX
 2410 IF BREAKRT=FALSE THEN PRINTTAB(X+14,Y+3)NSET$(R) : X=X+1 : PROC_PRINTSHAPE
 2420 ENDPROC
 2430 DEF PROC_ROTATE
 2440 ROT=R
 2450 ROT=ROT+1
 2460 IF ROT>3 THEN ROT=0
 2470 FOR SX=0 TO 3 : FOR SY=0 TO 3 : IF SETHB$(ROT,SX,SY) = BL$ : IF SETHB$(ROT,SX,SY) = SCREEN$(SX+X,SY+Y) THEN ENDPROC
 2475 NEXT SY : NEXT SX
 2480 PRINTTAB(X+14,Y+3)NSET$(R) : R=R+1 : IF R>3 THEN R=0
 2482 PROC_PRINTSHAPE
 2490 ENDPROC
 2500 DEF PROC_DOWN
 2505 DP=FALSE
 2510 FOR SX=0 TO 3 : FOR SY=0 TO 3 : IF SETHB$(R,SX,SY) = BL$ : IF SETHB$(R,SX,SY) = SCREEN$(SX+X,SY+Y+1) THEN DP=TRUE
 2515 NEXT SY : NEXT SX
 2518 PROC_CHECKREMOVELINE
 2520 IF DP=TRUE THEN FOR SX=0 TO 3 : FOR SY=0 TO 3 : SCREEN$(SX+X,SY+Y)=SCREEN$(SX+X,SY+Y)+SETHB$(R,SX,SY) : NEXT SY : NEXT SX : PROC_NEWBLOCK
 2530 IF DP=FALSE THEN PRINTTAB(X+14,Y+3)NSET$(R) : Y=Y+1 : PROC_PRINTSHAPE
 2540 ENDPROC
 2550 DEF PROC_TIME
 2551 AMSER=AMSER+1
 2570 ENDPROC
 2600 DEF PROC_NEWBLOCK
 2610 X=4 : Y=0 : R=0
 2620 IF RAND% = 1 THEN FOR S=0 TO 3 : SET$(S)=OBA$(S) : NSET$(S)=EOBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=OBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM PRINT R$PRI$(0)R$PRI$(1)
 2630 IF RAND% = 2 THEN FOR S=0 TO 3 : SET$(S)=TBA$(S) : NSET$(S)=ETBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=TBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM PRINT R$PRI$(0)R$PRI$(1)
 2640 IF RAND% = 3 THEN FOR S=0 TO 3 : SET$(S)=SBA$(S) : NSET$(S)=ESBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=SBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM PRINT R$PRI$(0)R$PRI$(1)
 2650 IF RAND% = 4 THEN FOR S=0 TO 3 : SET$(S)=ZBA$(S) : NSET$(S)=EZBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=ZBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM PRINT R$PRI$(0)R$PRI$(1)
 2660 IF RAND% = 5 THEN FOR S=0 TO 3 : SET$(S)=LBA$(S) : NSET$(S)=ELBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=LBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM PRINT R$PRI$(0)R$PRI$(1)
 2670 IF RAND% = 6 THEN FOR S=0 TO 3 : SET$(S)=JBA$(S) : NSET$(S)=EJBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=JBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM PRINT R$PRI$(0)R$PRI$(1)
 2680 IF RAND% = 7 THEN FOR S=0 TO 3 : SET$(S)=IBA$(S) : NSET$(S)=EIBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=IBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z :REM PRINT R$PRI$(0)R$PRI$(1)
 2690 RAND%=RND(7)
 2700 PROC_NEXTBLOCK
 2710 PROC_Print
 2720 PROC_PlayerInput
 2730 ENDPROC
 2740 DEF PROC_NEXTBLOCK
 2745 PRINTTAB(32,7)NIT$
 2750 IF RAND% = 1 THEN PRINTTAB(32,7)OBA$(0)
 2760 IF RAND% = 2 THEN PRINTTAB(32,7)TBA$(0)
 2770 IF RAND% = 3 THEN PRINTTAB(32,7)SBA$(0)
 2780 IF RAND% = 4 THEN PRINTTAB(32,7)ZBA$(0)
 2790 IF RAND% = 5 THEN PRINTTAB(32,7)LBA$(0)
 2800 IF RAND% = 6 THEN PRINTTAB(32,7)JBA$(0)
 2810 IF RAND% = 7 THEN PRINTTAB(32,7)IBA$(0)
 2820 ENDPROC
 3000 DEF PROC_CHECKREMOVELINE
 3010 FOR YA=17 TO 0 STEP -1
 3020 FOR XA=0 TO 11
 3030 IF YA=0 THEN ENDPROC
 3040 IF SCREEN$(XA,YA)<>BL$ THEN XA=0 : NEXT YA
 3050 NEXT XA
 3055 FOR DELXA=0 TO 11 : SCREEN$(DELXA,YA)=NBL$ : NEXT DELXA
 3060 ENDPROC
 2900 DEF PROC_REMOVELINE

 2910 ENDPROC

