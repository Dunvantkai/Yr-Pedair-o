DEF PROC_DOWN
COL=FALSE
FOR SX=0 TO 3 : FOR SY=0 TO 3 : IF COL=FALSE : IF SETHB$(R,SX,SY) = BL$ : IF SETHB$(R,SX,SY) = SCREEN$(SX+X,SY+Y+1) THEN COL=TRUE
NEXT SY : NEXT SX
IF COL=FALSE THEN PRINTTAB(X+14,Y+3)NSET$(R) : Y=Y+1 : PROC_PRINTSHAPE
IF COL=TRUE THEN SCORE%=SCORE%+5 : SCREEN$(SX+X,SY+Y)=SCREEN$(SX+X,SY+Y)+SETHB$(R,SX,SY) : NEXT SY : NEXT SX : PROC_NEWBLOCK 
ENDPROC


10 MODE 7
20 DIM SET$(3)
30 DIM NSET$(3)
40 DIM SETHB$(3,3,3)
50 DIM SCREEN$(14,21)
60 DIM OBA$(3)
70 OBA$(0)=BL$+BL$+D$+B$+B$+BL$+BL$
80 OBA$(1)=BL$+BL$+D$+B$+B$+BL$+BL$
90 OBA$(2)=BL$+BL$+D$+B$+B$+BL$+BL$
100 OBA$(3)=BL$+BL$+D$+B$+B$+BL$+BL$
110 DIM EOBA$(3)
120 EOBA$(0)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$
130 EOBA$(1)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$
140 EOBA$(2)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$
150 EOBA$(3)=NBL$+NBL$+D$+B$+B$+NBL$+NBL$
160 DIM OBAH$(3,3,3)
170 OBAH$(0,0,0)=BL$ :OBAH$(0,1,0)=BL$ :OBAH$(0,0,1)=BL$ :OBAH$(0,1,1)=BL$
180 OBAH$(1,0,0)=BL$ :OBAH$(1,1,0)=BL$ :OBAH$(1,0,1)=BL$ :OBAH$(1,1,1)=BL$
190 OBAH$(2,0,0)=BL$ :OBAH$(2,1,0)=BL$ :OBAH$(2,0,1)=BL$ :OBAH$(2,1,1)=BL$
200 OBAH$(3,0,0)=BL$ :OBAH$(3,1,0)=BL$ :OBAH$(3,0,1)=BL$ :OBAH$(3,1,1)=BL$

210 FOR S=0 TO 3 : SET$(S)=OBA$(S) : NSET$(S)=EOBA$(S) : NEXT S : FOR Z=0 TO 3 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SETHB$(Z,SX,SY)=OBAH$(Z,SX,SY) :NEXT SY :NEXT SX :NEXT Z





220 DEF PROC_DOWN
230 DP=FALSE
240 FOR SX=0 TO 3 : FOR SY=0 TO 3 : IF SETHB$(R,SX,SY) = BL$ : IF SETHB$(R,SX,SY) = SCREEN$(SX+X,SY+Y+1) THEN DP=TRUE
250 NEXT SY : NEXT SX
260 IF DP=TRUE THEN SCORE%=SCORE%+5 : FOR SX=0 TO 3 : FOR SY=0 TO 3 : SCREEN$(SX+X,SY+Y)=SCREEN$(SX+X,SY+Y)+SETHB$(R,SX,SY) : NEXT SY : NEXT SX : PROC_NEWBLOCK
270 IF DP=FALSE THEN PRINTTAB(X+14,Y+3)NSET$(R) : Y=Y+1 : PRINTTAB(X+14,Y+3)SET$(R)
280 ENDPROC


 
2550 DEF PROC_TIME

